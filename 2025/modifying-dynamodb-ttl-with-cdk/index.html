<!doctype html><html class="h-full antialiased" style=--header-position:sticky;--content-offset:0px;--header-height:64px;--header-mb:0px;--header-top:0px;--avatar-top:0px lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Modifying DynamoDB TTL with CDK - Cino</title>
<link rel=canonical href=https://cino.io/2025/modifying-dynamodb-ttl-with-cdk/><link rel=alternate type=application/rss+xml title=RSS href=https://cino.io/index.xml><link rel=icon type=image/png href=/favicon-96x96.png sizes=96x96><link rel=icon type=image/svg+xml href=/favicon.svg><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><meta name=apple-mobile-web-app-title content="Cino.io"><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://cino.io/2025/modifying-dynamodb-ttl-with-cdk/"><meta property="og:site_name" content="Cino"><meta property="og:title" content="Modifying DynamoDB TTL with CDK"><meta property="og:description" content="Ever tried to update the TTL attribute of a DynamoDB table using the AWS CDK and got a InvalidRequest in CDK or a ValidationException via the CLI? I did, and it took me a while to figure out why. In this post, I’ll explain what happened and how to avoid the same issue in the future. This is a short post, but I think it’s worth sharing because it can save you some time and frustration."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="2025"><meta property="article:published_time" content="2025-03-22T12:00:40+01:00"><meta property="article:modified_time" content="2025-03-22T12:00:40+01:00"><meta property="article:tag" content="Aws"><meta property="article:tag" content="Amazon Web Services"><meta property="article:tag" content="Tags/Dynamodb"><meta property="article:tag" content="Tags/Ttl"><meta property="article:tag" content="Tags/Time to Live"><meta property="article:tag" content="Cdk"><meta name=twitter:card content="summary"><meta name=twitter:title content="Modifying DynamoDB TTL with CDK"><meta name=twitter:description content="Ever tried to update the TTL attribute of a DynamoDB table using the AWS CDK and got a InvalidRequest in CDK or a ValidationException via the CLI? I did, and it took me a while to figure out why. In this post, I’ll explain what happened and how to avoid the same issue in the future. This is a short post, but I think it’s worth sharing because it can save you some time and frustration."><meta itemprop=name content="Modifying DynamoDB TTL with CDK"><meta itemprop=description content="Ever tried to update the TTL attribute of a DynamoDB table using the AWS CDK and got a InvalidRequest in CDK or a ValidationException via the CLI? I did, and it took me a while to figure out why. In this post, I’ll explain what happened and how to avoid the same issue in the future. This is a short post, but I think it’s worth sharing because it can save you some time and frustration."><meta itemprop=datePublished content="2025-03-22T12:00:40+01:00"><meta itemprop=dateModified content="2025-03-22T12:00:40+01:00"><meta itemprop=wordCount content="773"><meta itemprop=keywords content="Aws,Amazon Web Services,Tags/Dynamodb,Tags/Ttl,Tags/Time to Live,Cdk,Tags/Error,Tags/ValidationException,Tags/UpdateTimeToLive,Tags/InvalidRequest"><link rel=stylesheet href="https://cino.io/css/styles.min.8f79fc4195b59197ef0432b89dab6f0b745c2473b70975b868e1c0b56c1042e8.css" integrity="sha256-j3n8QZW1kZfvBDK4natvC3RcJHO3CXW4aOHAtWwQQug="><meta name=fediverse:creator content="@cino@fosstodon.org"><script async src="https://www.googletagmanager.com/gtag/js?id=G-GCGJ9S1XSX"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-GCGJ9S1XSX")}</script></head><body class="flex h-full flex-col bg-zinc-50"><div class="fixed inset-0 flex justify-center sm:px-8"><div class="flex w-full max-w-7xl lg:px-8"><div class="w-full bg-white ring-1 ring-zinc-100"></div></div></div><div class=relative><header class="pointer-events-none relative z-50 flex flex-col" style=height:var(--header-height);margin-bottom:var(--header-mb)><div class="top-0 z-10 h-16 pt-6" style=position:var(--header-position)><div class="sm:px-8 top-[var(--header-top,theme(spacing.6))] w-full" style=position:var(--header-inner-position)><div class="mx-auto max-w-7xl lg:px-8"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="relative flex gap-4"><div class="flex flex-1"><div class="h-10 w-10 rounded-full bg-white/90 p-0.5 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur"><a aria-label=Home class=pointer-events-auto href=https://cino.io/><img alt sizes=2.25rem src=/img/ricardo-cino-36x36.jpg decoding=async data-nimg=1 class="rounded-full bg-zinc-100 object-cover h-9 w-9" style=color:transparent width=512 height=512 alt="Ricardo Cino"></a></div></div><div class="flex flex-1 justify-end md:justify-center"><nav class="pointer-events-auto block"><ul class="flex rounded-full bg-white/90 px-3 text-sm font-medium text-zinc-800 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur"><li><a class="relative block px-3 py-2 transition hover:text-teal-500" href=/>Home</a></li></ul></nav></div><div class="flex justify-end md:flex-1"></div></div></div></div></div></div></div></header><main><div class="sm:px-8 mt-16 lg:mt-32"><div class="mx-auto max-w-7xl lg:px-8"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class=xl:relative><div class="mx-auto max-w-2xl"><a href=/ aria-label="Go back to articles" class="group mb-8 flex h-10 w-10 items-center justify-center rounded-full bg-white shadow-md shadow-zinc-800/5 ring-1 ring-zinc-900/5 transition dark:border dark:border-zinc-700/50 dark:bg-zinc-800 dark:ring-0 dark:ring-white/10 dark:hover:border-zinc-700 dark:hover:ring-white/20 lg:absolute lg:-left-5 lg:mb-0 lg:-mt-2 xl:-top-1.5 xl:left-0 xl:mt-0"><svg viewBox="0 0 16 16" fill="none" aria-hidden="true" class="h-4 w-4 stroke-zinc-500 transition group-hover:stroke-zinc-700 dark:stroke-zinc-500 dark:group-hover:stroke-zinc-400"><path d="M7.25 11.25 3.75 8m0 0 3.5-3.25M3.75 8h8.5" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></a><article><header class="flex flex-col"><time datetime=2025-03-22 class="order-first flex items-center text-base text-zinc-400 dark:text-zinc-500"><span class="h-4 w-0.5 rounded-full bg-zinc-200 dark:bg-zinc-500"></span>
<span class=ml-3>March 22, 2025</span>
<span class="h-4 ml-4 w-0.5 rounded-full bg-zinc-200 dark:bg-zinc-500"></span>
<span class=ml-3>4 min read</span></time><div class="relative mt-4 text-zinc-400"><a href=/tags/aws/ class=hover:text-zinc-200>#aws</a>, <a href=/tags/amazon-web-services/ class=hover:text-zinc-200>#amazon web services</a>, <a href=/tags/dynamodb/ class=hover:text-zinc-200>#dynamodb</a>, <a href=/tags/ttl/ class=hover:text-zinc-200>#ttl</a>, <a href=/tags/time-to-live/ class=hover:text-zinc-200>#time to live</a>, <a href=/tags/cdk/ class=hover:text-zinc-200>#cdk</a>, <a href=/tags/error/ class=hover:text-zinc-200>#error</a>, <a href=/tags/validationexception/ class=hover:text-zinc-200>#ValidationException</a>, <a href=/tags/updatetimetolive/ class=hover:text-zinc-200>#UpdateTimeToLive</a>, <a href=/tags/invalidrequest/ class=hover:text-zinc-200>#InvalidRequest</a></div><h1 class="mt-6 text-4xl font-bold tracking-tight text-zinc-800 dark:text-zinc-100 sm:text-5xl">Modifying DynamoDB TTL with CDK</h1></header><div class="mt-8 prose dark:prose-invert"><p>Ever tried to update the TTL attribute of a DynamoDB table using the AWS CDK and got a <code>InvalidRequest</code> in CDK or a <code>ValidationException</code> via the CLI? I did, and it took me a while to figure out why. In this post, I&rsquo;ll explain what happened and how to avoid the same issue in the future. This is a short post, but I think it&rsquo;s worth sharing because it can save you some time and frustration.</p><h2 id=introduction>Introduction</h2><p>Very recently I spent a few hours trying to figure out why I was getting a <code>ValidationException</code> when trying to update the TTL attribute of a DynamoDB table using the AWS CDK. The error message was not very helpful, and I couldn&rsquo;t find any documentation that explained the issue. After some digging (and asking around on Slack), I discovered that the problem was related to the fact that the TTL attribute was already set to a different value, and I was trying to change it to a new one which is not allowed in a single deployment.</p><h2 id=modifying-dynamodb-ttl-with-cdk>Modifying DynamoDB TTL with CDK</h2><h3 id=the-errors>The Error(s)</h3><p>When you try to update the TTL attribute of a DynamoDB table using the AWS CDK, you might encounter the following error:</p><blockquote><p>Invalid request provided: Cannot change time-to-live attribute name. To update this property, you must first disable TTL then enable TTL with the new attribute name.</p></blockquote><p>For me this was a surprise and wasn&rsquo;t aware this limitation existed. Followed by this error I thought, let me try this by the CLI and see if I can update it manually before deploying the CDK Stack. So to clear up; I was trying to disable the TTL by CLI and than re-run the stack with the new TTL attribute.</p><p>Of course that didn&rsquo;t work either, because the state of the CloudFormation stack was still in the previous state. So when validating the stack it would still throw the same exact error.</p><p>Next up I thought, let&rsquo;s try to disable the TTL via the CLI and then re-enable it with the new attribute name. This is where I got the following error:</p><blockquote><p>An error occurred (ValidationException) when calling the UpdateTimeToLive operation: Time to live has been modified multiple times within a fixed interval</p></blockquote><h3 id=why-was-i-confused>Why was I confused</h3><p>To me this was a experience of surprises. I looked at the documentation and it didn&rsquo;t mention anything about this limitation. I thought I could just change the TTL attribute name and be done with it. This was mainly due to the DynamoDB CloudFormation documentation about the <code>TimeToLiveSpecification</code> property, which doesn&rsquo;t mention anything about this limitation. It actually mentions you can modify this property without any interruption on <a href=https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-dynamodb-table.html#cfn-dynamodb-table-timetolivespecification target=_blank>this page</a>.</p><p>And yes, there is a note below that saying there are limitations on DynamoDb and links to a new page, which does <em>not</em> mention the <code>TimeToLiveSpecification</code> property.</p><p>Now the second error I got was even more confusing. I was trying to disable the TTL and then re-enable it with a new attribute name, but I got an error saying that the TTL had been modified multiple times within a fixed interval. Again, this was something I hadn&rsquo;t yet spotted in any of the documentation which was a error on my side. I opened the documentation for <a href=https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_UpdateTimeToLive.html target=_blank>UpdateTimeToLive</a> and immediately scrolled down to the <code>Errors</code> section and this did not include the <code>ValidationException</code>.</p><p>However, at the top of the page that discusses the <code>UpdateTimeToLive</code> operation, it clearly states that:</p><blockquote><p>TimeToLiveSpecification. It can take up to one hour for the change to fully process. Any additional UpdateTimeToLive calls for the same table during this one hour duration result in a ValidationException.</p></blockquote><p>So, if you try to disable the TTL and then re-enable it with a new attribute name within that one hour duration, you&rsquo;ll get the <code>ValidationException</code> error.</p><h2 id=conclusion>Conclusion</h2><p>In conclusion if you use any kind of Infrastructure as code tool, like the AWS CDK, you need to be aware of this limitation when modifying the TTL attribute of a DynamoDB table. You can&rsquo;t just change the attribute name and expect it to work. You&rsquo;ll need to:</p><ol><li>Disable the TTL</li><li>Deploy the change</li><li>Wait for the change to be applied (up to one hour)</li><li>Enable the TTL with the new attribute name</li><li>Deploy the change</li><li>Wait for the change to be applied (up to one hour)</li></ol><p>In hindsight, yes I could&rsquo;ve spotted this in the documentation but I clearly didn&rsquo;t and as a result I lost multiple hours on researching but also, deploying.. and waiting for the changes to be applied. So I hope this post helps you avoid the same issue in the future.</p><h3 id=sources>Sources</h3><ul><li><a href=https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/TTL.html target=_blank>docs.aws.amazon.com/amazondynamodb/latest/developerguide/TTL.html</a></li><li><a href=https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-dynamodb-table.html#cfn-dynamodb-table-timetolivespecification target=_blank>docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-dynamodb-table.html#cfn-dynamodb-table-timetolivespecification</a></li><li><a href=https://awscli.amazonaws.com/v2/documentation/api/latest/reference/dynamodb/update-time-to-live.html target=_blank>awscli.amazonaws.com/v2/documentation/api/latest/reference/dynamodb/update-time-to-live.html</a></li></ul></div></article></div></div></div></div></div></div></main><footer class=mt-32><div class=sm:px-8><div class="mx-auto max-w-7xl lg:px-8"><div class="border-t border-zinc-100 pt-10 pb-16 0"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="flex flex-col items-center justify-between gap-6 sm:flex-row"><div class="flex gap-6 text-sm font-medium text-zinc-800"><a class="transition hover:text-teal-500" href=/>Home</a></div><p class="text-sm text-zinc-400">© 2025 Cino Consultancy<br><span class=text-xs>KVK: 89913019</span></p></div></div></div></div></div></div></footer></div></body></html>