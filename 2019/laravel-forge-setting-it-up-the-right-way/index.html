<!doctype html><html class="h-full antialiased" style=--header-position:sticky;--content-offset:0px;--header-height:64px;--header-mb:0px;--header-top:0px;--avatar-top:0px lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Laravel Forge: setting it up the right way - Cino</title><link rel=canonical href=https://cino.io/2019/laravel-forge-setting-it-up-the-right-way/><link rel=alternate type=application/rss+xml title=RSS href=https://cino.io/index.xml><link rel=apple-touch-icon sizes=57x57 href=/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><meta name=msapplication-TileColor content="#ffffff"><meta name=msapplication-TileImage content="/ms-icon-144x144.png"><meta name=theme-color content="#ffffff"><meta property="og:url" content="https://cino.io/2019/laravel-forge-setting-it-up-the-right-way/"><meta property="og:site_name" content="Cino"><meta property="og:title" content="Laravel Forge: setting it up the right way"><meta property="og:description" content="For the last couple of years, I’ve been creating servers with Laravel Forge and normally I would advise against doing this (In favor of running containers or other load balanced tasks), but for the sake of giving advice to those who do want to do it, this is the first post I’ll spend time on it.
For the record, I’ll be writing from an AWS perspective since this is the only provider I have extensive experience with on Laravel Forge but I’ll expect the others to work quite the same."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="2019"><meta property="article:published_time" content="2019-04-20T00:00:00+00:00"><meta property="article:modified_time" content="2019-04-20T00:00:00+00:00"><meta property="article:tag" content="Php"><meta name=twitter:card content="summary"><meta name=twitter:title content="Laravel Forge: setting it up the right way"><meta name=twitter:description content="For the last couple of years, I’ve been creating servers with Laravel Forge and normally I would advise against doing this (In favor of running containers or other load balanced tasks), but for the sake of giving advice to those who do want to do it, this is the first post I’ll spend time on it.
For the record, I’ll be writing from an AWS perspective since this is the only provider I have extensive experience with on Laravel Forge but I’ll expect the others to work quite the same."><meta itemprop=name content="Laravel Forge: setting it up the right way"><meta itemprop=description content="For the last couple of years, I’ve been creating servers with Laravel Forge and normally I would advise against doing this (In favor of running containers or other load balanced tasks), but for the sake of giving advice to those who do want to do it, this is the first post I’ll spend time on it.
For the record, I’ll be writing from an AWS perspective since this is the only provider I have extensive experience with on Laravel Forge but I’ll expect the others to work quite the same."><meta itemprop=datePublished content="2019-04-20T00:00:00+00:00"><meta itemprop=dateModified content="2019-04-20T00:00:00+00:00"><meta itemprop=wordCount content="972"><meta itemprop=keywords content="Php"><link rel=stylesheet href=/css/styles.76fc68452d18f36a69152f3dbb34e89572b4ff0c95e50aaa17bd44cfe5ae32a4.css integrity="sha256-dvxoRS0Y82ppFS89uzTolXK0/wyV5QqqF71Ez+WuMqQ=" crossorigin=anonymous><meta name=fediverse:creator content="@cino@fosstodon.org"><script async src="https://www.googletagmanager.com/gtag/js?id=G-GCGJ9S1XSX"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-GCGJ9S1XSX")}</script></head><body class="flex h-full flex-col bg-zinc-50"><div class="fixed inset-0 flex justify-center sm:px-8"><div class="flex w-full max-w-7xl lg:px-8"><div class="w-full bg-white ring-1 ring-zinc-100"></div></div></div><div class=relative><header class="pointer-events-none relative z-50 flex flex-col" style=height:var(--header-height);margin-bottom:var(--header-mb)><div class="top-0 z-10 h-16 pt-6" style=position:var(--header-position)><div class="sm:px-8 top-(--header-top,--spacing(6)) w-full" style=position:var(--header-inner-position)><div class="mx-auto max-w-7xl lg:px-8"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="relative flex gap-4"><div class="flex flex-1"><div class="h-10 w-10 rounded-full bg-white/90 p-0.5 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur-sm"><a aria-label=Home class=pointer-events-auto href=https://cino.io/><img alt sizes=2.25rem src=/img/ricardo-cino-36x36.png decoding=async data-nimg=1 class="rounded-full bg-zinc-100 object-cover h-9 w-9" style=color:transparent width=512 height=512 alt="Ricardo Cino"></a></div></div><div class="relative flex justify-end flex-1"><div class="mt-2 flex gap-6"><a class="group -m-1 p-1 pointer-events-auto" aria-label="Follow on Bluesky" href=https://bsky.app/profile/cino.io target=_blank><svg viewBox="0 0 24 24" width="24" height="24" class="h-6 w-6 fill-zinc-500 transition group-hover:fill-zinc-600 dark:fill-zinc-400 dark:group-hover:fill-zinc-300"><path style="stroke:none;fill-rule:nonzero" d="M4.550781 2.792969c2.410157 1.773437 5 5.371093 5.949219 7.296875V15.1875C10.5 15.078125 10.457031 15.203125 10.367188 15.464844 9.871094 16.894531 7.929688 22.476562 3.5 18.015625c-2.332031-2.351563-1.253906-4.699219 2.996094-5.40625-2.429688.40625-5.164063-.265625-5.914063-2.894531C.367188 8.960938.0 4.304688.0 3.675781.0.523438 2.816406 1.515625 4.550781 2.792969zm11.898438.0c-2.410157 1.773437-5 5.371093-5.949219 7.296875V15.1875C10.5 15.078125 10.542969 15.203125 10.632812 15.464844 11.128906 16.894531 13.070312 22.476562 17.5 18.015625c2.332031-2.351563 1.253906-4.699219-2.996094-5.40625 2.429688.40625 5.164063-.265625 5.914063-2.894531C20.632812 8.960938 21 4.304688 21 3.675781c0-3.152343-2.816406-2.160156-4.550781-.882812zm0 0"/></svg>
</a><a class="group -m-1 p-1 pointer-events-auto" aria-label="Follow on Mastodon" href=https://fosstodon.org/@cino rel=me target=_blank><svg viewBox="0 0 16 16" aria-hidden="true" class="h-6 w-6 fill-zinc-500 transition group-hover:fill-zinc-600 dark:fill-zinc-400 dark:group-hover:fill-zinc-300"><path fill="#828282" d="M15.659 9.592C15.424 10.72 13.553 11.956 11.404 12.195 10.283 12.32 9.18 12.434 8.003 12.384 6.079 12.302 4.56 11.956 4.56 11.956 4.56 12.13 4.572 12.297 4.595 12.452c.25 1.772 1.883 1.878 3.43 1.927C9.586 14.429 10.976 14.02 10.976 14.02L11.04 15.337S9.948 15.884 8.003 15.984C6.93 16.039 5.598 15.959 4.047 15.576.683 14.746.104 11.4.015 8.006-.012 6.998.005 6.048.005 5.253.005 1.782 2.443.765 2.443.765 3.672.238 5.782.017 7.975.0H8.029c2.192.017 4.303.238 5.532.765.0.0 2.438 1.017 2.438 4.488.0.0.0310000000000006 2.561-.34 4.339zm-2.535-4.07V9.725H11.339V5.646c0-.86-.388-1.296-1.164-1.296C9.317 4.35 8.887 4.867 8.887 5.891V8.124H7.113V5.891C7.113 4.867 6.683 4.35 5.825 4.35c-.776.0-1.164.436-1.164 1.296V9.725H2.876V5.522c0-.859.235-1.541.706-2.046.485-.505 1.121-.764 1.911-.764C6.406 2.712 7.098 3.039 7.555 3.695L8 4.39l.445-.695C8.902 3.039 9.594 2.712 10.507 2.712 11.297 2.712 11.933 2.971 12.418 3.476 12.889 3.981 13.124 4.663 13.124 5.522z" style="stroke:none;stroke-miterlimit:10;fill-rule:evenodd"/></svg>
</a><a class="group -m-1 p-1 pointer-events-auto" aria-label="Follow on GitHub" href=https://github.com/cino target=_blank><svg viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6 fill-zinc-500 transition group-hover:fill-zinc-600 dark:fill-zinc-400 dark:group-hover:fill-zinc-300"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.475 2 2 6.588 2 12.253c0 4.537 2.862 8.369 6.838 9.727.5.09.687-.218.687-.487.0-.243-.013-1.05-.013-1.91C7 20.059 6.35 18.957 6.15 18.38c-.113-.295-.6-1.205-1.025-1.448-.35-.192-.85-.667-.013-.68.788-.012 1.35.744 1.538 1.051.9 1.551 2.338 1.116 2.912.846.088-.666.35-1.115.638-1.371-2.225-.256-4.55-1.14-4.55-5.062.0-1.115.387-2.038 1.025-2.756-.1-.256-.45-1.307.1-2.717.0.0.837-.269 2.75 1.051.8-.23 1.65-.346 2.5-.346s1.7.115 2.5.346c1.912-1.333 2.75-1.05 2.75-1.05.55 1.409.2 2.46.1 2.716.637.718 1.025 1.628 1.025 2.756.0 3.934-2.337 4.806-4.562 5.062.362.32.675.936.675 1.897.0 1.371-.013 2.473-.013 2.82.0.268.188.589.688.486a10.039 10.039.0 004.932-3.74A10.447 10.447.0 0022 12.253C22 6.588 17.525 2 12 2z"/></svg>
</a><a class="group -m-1 p-1 pointer-events-auto" aria-label="Follow on LinkedIn" href=https://www.linkedin.com/in/cinoricardo/ target=_blank><svg viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6 fill-zinc-500 transition group-hover:fill-zinc-600 dark:fill-zinc-400 dark:group-hover:fill-zinc-300"><path d="M18.335 18.339H15.67v-4.177c0-.996-.02-2.278-1.39-2.278-1.389.0-1.601 1.084-1.601 2.205v4.25h-2.666V9.75h2.56v1.17h.035c.358-.674 1.228-1.387 2.528-1.387 2.7.0 3.2 1.778 3.2 4.091v4.715zM7.003 8.575A1.546 1.546.0 015.455 7.026a1.548 1.548.0 111.547 1.549zm1.336 9.764H5.666V9.75H8.34v8.589zM19.67 3H4.329C3.593 3 3 3.58 3 4.297v15.406C3 20.42 3.594 21 4.328 21h15.338C20.4 21 21 20.42 21 19.703V4.297C21 3.58 20.4 3 19.666 3h.003z"/></svg></a></div></div></div></div></div></div></div></div></header><main><div class="sm:px-8 mt-16 lg:mt-32"><div class="mx-auto max-w-7xl lg:px-8"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class=xl:relative><div class="mx-auto max-w-2xl"><a href=/ aria-label="Go back to articles" class="group mb-8 flex h-10 w-10 items-center justify-center rounded-full bg-white shadow-md shadow-zinc-800/5 ring-1 ring-zinc-900/5 transition dark:border dark:border-zinc-700/50 dark:bg-zinc-800 dark:ring-0 dark:ring-white/10 dark:hover:border-zinc-700 dark:hover:ring-white/20 lg:absolute lg:-left-5 lg:mb-0 lg:-mt-2 xl:-top-1.5 xl:left-0 xl:mt-0"><svg viewBox="0 0 16 16" fill="none" aria-hidden="true" class="h-4 w-4 stroke-zinc-500 transition group-hover:stroke-zinc-700 dark:stroke-zinc-500 dark:group-hover:stroke-zinc-400"><path d="M7.25 11.25 3.75 8m0 0 3.5-3.25M3.75 8h8.5" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></a><article><header class="flex flex-col"><time datetime=2019-04-20 class="order-first flex items-center text-base text-zinc-400 dark:text-zinc-500"><span class="h-4 w-0.5 rounded-full bg-zinc-200 dark:bg-zinc-500"></span>
<span class=ml-3>April 20, 2019</span>
<span class="h-4 ml-4 w-0.5 rounded-full bg-zinc-200 dark:bg-zinc-500"></span>
<span class=ml-3>5 min read</span></time><div class="relative mt-4 text-zinc-400"><a href=/tags/php/ class=hover:text-zinc-200>#php</a></div><h1 class="mt-6 text-4xl font-bold tracking-tight text-zinc-800 dark:text-zinc-100 sm:text-5xl">Laravel Forge: setting it up the right way</h1></header><div class="mt-8 prose dark:prose-invert"><p>For the last couple of years, I’ve been creating servers with Laravel Forge and normally I would advise against doing this (In favor of running containers or other load balanced tasks), but for the sake of giving advice to those who do want to do it, this is the first post I’ll spend time on it.</p><p>For the record, I’ll be writing from an AWS perspective since this is the only provider I have extensive experience with on Laravel Forge but I’ll expect the others to work quite the same.</p><h2 id=first-things-first>First things first</h2><p>When you start to use Laravel Forge with AWS you’ll need to create an IAM user with the right amount of permissions to create and manage your servers. This should always be from the least access principle. The documentation of Laravel Forge suggests you’ll create a user with the policies <code>AmazonEC2FullAccess</code> and <code>AmazonVPCFullAccess</code>. However, this looks like a bit too much access in my opinion and my advice would be to initially grant access with these policies and closely monitor what features are actually necessary with the IAM Access Advisor.</p><p>When creating the Laravel Forge user you will need to enable programmatic access to provide Forge with an access key and secret. I’d like to point out that it is <strong>recommended</strong> to rotate these credentials every 90 days but I’ll suggest making a reminder for every <strong>60 days</strong>. <em>Personal preferences though</em>.</p><h2 id=networking>Networking</h2><p>This is actually something that annoys me quite a lot, when using a cloud provider for your servers it can be confusing to find out that you are using a double “firewall”. For example, in AWS we use the concept of security groups where you’ll define the ports which are open and for whom. When using Laravel Forge the server will also have UFW installed. These two different will have different ports open; on UFW only ports 22, 80, and 443 will be opened, which is correct. On the AWS Security Group it will look like this:</p><picture><source media="(min-width: 600px)" srcset=/2019/laravel-forge-setting-it-up-the-right-way/laravel-forge-ec2-security-group-example_hu_61add0bad5918d9b.webp type=image/webp><source media="(min-width: 300px)" srcset=/2019/laravel-forge-setting-it-up-the-right-way/laravel-forge-ec2-security-group-example_hu_b73fd8bb23d80323.webp type=image/webp><source media="(max-width: 300px)" srcset=/2019/laravel-forge-setting-it-up-the-right-way/laravel-forge-ec2-security-group-example_hu_bddd2c3fa43c2d27.webp type=image/webp><img loading=lazy src=/2019/laravel-forge-setting-it-up-the-right-way/laravel-forge-ec2-security-group-example_hu_f2c566e031813591.webp alt="Laravel Forge Security Group Exaple" width=100% height=172></picture><p>Especially when you see inbound ports 0-65535 open it should warn you that something isn’t as it should be. AWS Security Advisors will also advise you to look at this because it is uncommon. My first step would be to modify this to allow SSH from the Laravel Forge servers (IPs are available in their <a href=https://forge.laravel.com/docs/1.0/introduction.html#forge-ip-addresses target=_blank>documentation</a>), your own IP/bastion, and just HTTP/HTTPS for the web.</p><p>Whenever someone will try to access any other port on your domain it will be killed on network-level within AWS and will never even reach your server.</p><p>Another big reason for setting these rules on the security group is that your AWS Console actually shows you the active rules applied to your instance. It can be really confusing if you’re going through the console, seeing all the ports open and when trying to connect realizing there is a UFW active on the server level.</p><h2 id=source-provider-credentials>Source Provider Credentials</h2><p>Alright, this is one that bit me in the ass pretty hard. When you add a source provider like GitHub to your Laravel Forge account the default behavior is that Laravel Forge generates an SSH key on the server and adds this key to the Source Provider user on the account level. This means that this specific server can clone <strong>any</strong> repository that the user has access to.</p><p>As mentioned when providing Laravel Forge access to AWS we should provide access based on the least access principle, if you’re granting git access this way <strong>you’re doing it wrong</strong>. So please, disable the following checkbox when creating a server.</p><picture><source media="(min-width: 600px)" srcset=/2019/laravel-forge-setting-it-up-the-right-way/laravel-forge-ssh-key-source-control-providers_hu_3caa2f642f6682b1.webp type=image/webp><source media="(min-width: 300px)" srcset=/2019/laravel-forge-setting-it-up-the-right-way/laravel-forge-ssh-key-source-control-providers_hu_ef7e21e5b87fed57.webp type=image/webp><source media="(max-width: 300px)" srcset=/2019/laravel-forge-setting-it-up-the-right-way/laravel-forge-ssh-key-source-control-providers_hu_dac3d41cced7e480.webp type=image/webp><img loading=lazy src=/2019/laravel-forge-setting-it-up-the-right-way/laravel-forge-ssh-key-source-control-providers_hu_4236b447f2745cda.webp alt="Laravel Forge SSH Key Source Control Providers" width=100% height=55></picture><p>The correct way to go forward is when deploying a site on the newly created server instance is to create a deploy key in the repository you’d like the server to have access to.</p><p>This is also documented in the documentation of Laravel Forge but as the default behavior is the less-secure behavior I found it more than important to mention this.</p><p>Just to give you an example, imagine having 50+ servers managed by Laravel Forge and every single server has access to all of your GitHub repositories (when the user has access to your complete organization) and <strong>one</strong> of these servers is compromised, the source code of all your projects are compromised. This seems like a pretty big risk to me.</p><h2 id=php--memory>PHP & Memory</h2><p>The main usage of Laravel Forge is (as expected) for web development in PHP and thus PHP is configured when creating a server. However, when you look into the PHP configuration you’ll find that the memory_limit is set to 512MB which is crazy high for a normal web application. (WordPress defaults to 40 for example). My first step would be to lower this to 128MB or even 64MB if you are sure you don’t need more.</p><h3 id=php-fpm>PHP-FPM</h3><p>I’m planning on writing an extensive post about php-fpm and the settings around <code>pm.max_children</code>, <code>pm.start_servers</code>, <code>pm.min_spare_servers</code> and <code>pm.max_spare_servers</code> for now, I’m going to keep it as simple as advising you to visit the <a href=https://spot13.com/pmcalculator/ target=_blank>calculator</a> made by <a href=https://spot13.com target=_blank>Chris Moore</a>.</p><p>Make sure you enter the correct values in the calculator for the amount of memory your server has and the max memory consumption per request setup as memory_limit in the previously mentioned configuration.</p><p>Update: <a href=/2019/optimizing-php-fpm/ target=_blank>PHP FPM and Memory</a></p><h2 id=databases>Databases</h2><p>You have the option to auto-create your Mysql database which will be fine in most cases. Nothing special on that part besides since we never explicitly opened the 3306 port to the public you’ll need to access the database with an SSH connection which is actually displayed on the database page these days!
That’s a wrap</p><p>This is about it for my main frustrations of the things I change immediately after setting up a new instance with Laravel Forge. There are many other Laravel Forge-related topics I’m going to rant write about as there are more small things that need adjustment.</p></div></article></div></div></div></div></div></div></main><footer class=mt-32><div class=sm:px-8><div class="mx-auto max-w-7xl lg:px-8"><div class="border-t border-zinc-100 pt-10 pb-16 0"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="flex flex-col items-center justify-between gap-6 sm:flex-row"><div class="flex gap-6 text-sm font-medium text-rich-black"><a class="transition hover:text-dark-cyan" href=/>Home</a></div><p class="text-sm text-rich-black">© 2025 Ricardo Cino<br></p></div></div></div></div></div></div></footer></div></body></html>